{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<div class="medicare-form">
    <form method="post">
        {% csrf_token %}
        <div class="form-group">
            <label for="{{ form.state.id_for_label }}">State</label>
            {{ form.state }}
            {% if form.state.errors %}
            <ul class="errorlist">
                {% for error in form.state.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
        <div class="form-group">
            <label for="{{ form.procedure_code.id_for_label }}">CPT Code</label>
            {{ form.procedure_code }}
            {% if form.procedure_code.errors %}
            <ul class="errorlist">
                {% for error in form.procedure_code.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
        <button type="submit" class="btn btn-primary">Lookup Rate</button>
    </form>
</div>

{% if rate %}
<div class="results-section">
    <h2>Fee Schedule Rate</h2>
    <table class="results-table">
        <tr>
            <th>State</th>
            <td>{{ rate.fee_schedule.state.state_name }} ({{ rate.fee_schedule.state.state_code }})</td>
        </tr>
        <tr>
            <th>Procedure Code</th>
            <td>{{ rate.procedure_code.procedure_code }}</td>
        </tr>
        <tr>
            <th>Description</th>
            <td>{{ rate.procedure_code.description }}</td>
        </tr>
        <tr>
            <th>Region</th>
            <td>{{ rate.region.region_name }}</td>
        </tr>
        <tr>
            <th>Rate</th>
            <td>${{ rate.rate }}</td>
        </tr>
        <tr>
            <th>Unit</th>
            <td>{{ rate.rate_unit }}</td>
        </tr>
    </table>
</div>
{% endif %}

